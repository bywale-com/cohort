{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 24, "column": 0}, "map": {"version":3,"sources":["file:///home/ubuntu/cohort/lib/sanity.ts"],"sourcesContent":["import { createClient } from '@sanity/client'\nimport imageUrlBuilder from '@sanity/image-url'\n\nconst projectId = process.env.NEXT_PUBLIC_SANITY_PROJECT_ID\nconst dataset = process.env.NEXT_PUBLIC_SANITY_DATASET || 'production'\n\n// Create client only if projectId is available\nlet clientInstance: ReturnType<typeof createClient> | null = null\n\nfunction getClient() {\n  if (!projectId) {\n    return null\n  }\n  \n  if (!clientInstance) {\n    clientInstance = createClient({\n      projectId,\n      dataset,\n      useCdn: true,\n      apiVersion: '2024-01-01',\n    })\n  }\n  \n  return clientInstance\n}\n\n// Create client directly instead of using Proxy to avoid potential issues\nexport const client = (() => {\n  if (!projectId) {\n    // Return a mock client that will throw on fetch\n    return {\n      fetch: async () => {\n        throw new Error(\n          'Missing NEXT_PUBLIC_SANITY_PROJECT_ID. Please add it to your .env.local file.'\n        )\n      }\n    } as any\n  }\n  return getClient()!\n})()\n\nconst builder = projectId ? imageUrlBuilder(getClient()!) : null\n\nexport function urlFor(source: any) {\n  if (!builder) {\n    throw new Error('Sanity is not configured. Please set NEXT_PUBLIC_SANITY_PROJECT_ID in .env.local')\n  }\n  return builder.image(source)\n}\n\n// GROQ query for all posts (only published, excluding drafts)\nexport const postsQuery = `*[_type == \"post\" && !(_id in path(\"drafts.**\"))] | order(publishedAt desc) {\n  _id,\n  title,\n  author,\n  publishedAt,\n  excerpt,\n  coverImage,\n  \"slug\": slug.current\n}`\n\n// GROQ query for single post (only published, excluding drafts)\nexport const postQuery = `*[_type == \"post\" && !(_id in path(\"drafts.**\")) && slug.current == $slug][0] {\n  _id,\n  title,\n  author,\n  publishedAt,\n  excerpt,\n  coverImage,\n  body,\n  \"slug\": slug.current\n}`\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAEA,MAAM;AACN,MAAM,UAAU,kDAA0C;AAE1D,+CAA+C;AAC/C,IAAI,iBAAyD;AAE7D,SAAS;IACP;;IAIA,IAAI,CAAC,gBAAgB;QACnB,iBAAiB,IAAA,8LAAY,EAAC;YAC5B;YACA;YACA,QAAQ;YACR,YAAY;QACd;IACF;IAEA,OAAO;AACT;AAGO,MAAM,SAAS,CAAC;IACrB;;IAUA,OAAO;AACT,CAAC;AAED,MAAM,UAAU,uCAAY,IAAA,mLAAe,EAAC,eAAgB;AAErD,SAAS,OAAO,MAAW;IAChC,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO,QAAQ,KAAK,CAAC;AACvB;AAGO,MAAM,aAAa,CAAC;;;;;;;;CAQ1B,CAAC;AAGK,MAAM,YAAY,CAAC;;;;;;;;;CASzB,CAAC"}},
    {"offset": {"line": 90, "column": 0}, "map": {"version":3,"sources":["file:///home/ubuntu/cohort/app/insights/page.tsx"],"sourcesContent":["import Link from \"next/link\";\nimport Navigation from \"@/components/Navigation\";\nimport Footer from \"@/components/Footer\";\nimport { client, postsQuery } from \"@/lib/sanity\";\nimport Image from \"next/image\";\nimport { urlFor } from \"@/lib/sanity\";\n\nimport { Metadata } from \"next\";\n\nconst baseUrl = process.env.NEXT_PUBLIC_SITE_URL || \"https://cohort.example.com\";\n\nexport const metadata: Metadata = {\n  title: \"Insights - Cohort\",\n  description: \"Blog posts and insights about shift coverage management.\",\n  openGraph: {\n    title: \"Insights - Cohort\",\n    description: \"Blog posts and insights about shift coverage management.\",\n    url: `${baseUrl}/insights`,\n    siteName: \"Cohort\",\n    type: \"website\",\n  },\n  twitter: {\n    card: \"summary\",\n    title: \"Insights - Cohort\",\n    description: \"Blog posts and insights about shift coverage management.\",\n  },\n};\n\nasync function getPosts() {\n  // Check if Sanity is configured\n  const projectId = process.env.NEXT_PUBLIC_SANITY_PROJECT_ID;\n  if (!projectId) {\n    console.log(\"[getPosts] No NEXT_PUBLIC_SANITY_PROJECT_ID found\");\n    return [];\n  }\n  \n  console.log(\"[getPosts] Project ID:\", projectId);\n  console.log(\"[getPosts] Query:\", postsQuery);\n  \n  try {\n    const posts = await client.fetch(postsQuery);\n    console.log(\"[getPosts] Fetched posts count:\", posts?.length || 0);\n    if (posts && posts.length > 0) {\n      console.log(\"[getPosts] First post:\", JSON.stringify(posts[0], null, 2));\n    }\n    return posts || [];\n  } catch (error) {\n    console.error(\"[getPosts] Error fetching posts:\", error);\n    if (error instanceof Error) {\n      console.error(\"[getPosts] Error message:\", error.message);\n      console.error(\"[getPosts] Error stack:\", error.stack);\n    }\n    return [];\n  }\n}\n\nexport default async function Insights() {\n  const posts = await getPosts();\n\n  return (\n    <div className=\"min-h-screen flex flex-col\">\n      <Navigation />\n      <main className=\"flex-grow\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24\">\n          <h1 className=\"text-4xl font-bold mb-4\">Insights</h1>\n          <p className=\"text-xl text-gray-600 mb-12\">\n            Thoughts on shift coverage, operations, and building better systems.\n          </p>\n          {posts.length === 0 ? (\n            <div className=\"text-center py-12\">\n              {!process.env.NEXT_PUBLIC_SANITY_PROJECT_ID ? (\n                <>\n                  <p className=\"text-gray-500 mb-4\">\n                    Sanity CMS is not configured yet.\n                  </p>\n                  <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-6 max-w-2xl mx-auto text-left\">\n                    <h3 className=\"font-semibold mb-2\">Setup Instructions:</h3>\n                    <ol className=\"list-decimal list-inside space-y-2 text-sm text-gray-700\">\n                      <li>Run: <code className=\"bg-gray-100 px-2 py-1 rounded\">npx sanity login</code></li>\n                      <li>Run: <code className=\"bg-gray-100 px-2 py-1 rounded\">npx sanity init</code> (choose existing project or create new)</li>\n                      <li>Add your Project ID to <code className=\"bg-gray-100 px-2 py-1 rounded\">.env.local</code></li>\n                      <li>Restart your dev server</li>\n                    </ol>\n                    <p className=\"text-xs text-gray-600 mt-4\">\n                      Or create a project manually at{\" \"}\n                      <a href=\"https://sanity.io/manage\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 underline\">\n                        sanity.io/manage\n                      </a>\n                    </p>\n                  </div>\n                </>\n              ) : (\n                <>\n                  <p className=\"text-gray-500 mb-4\">\n                    No posts yet. Add content in Sanity Studio!\n                  </p>\n                  <Link\n                    href=\"/studio\"\n                    className=\"text-blue-600 hover:text-blue-800 underline\"\n                  >\n                    Go to Sanity Studio â†’\n                  </Link>\n                </>\n              )}\n            </div>\n          ) : (\n            <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-8\">\n              {posts.map((post: any) => (\n                <Link\n                  key={post._id}\n                  href={`/insights/${post.slug}`}\n                  className=\"bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow overflow-hidden\"\n                >\n                  {post.coverImage && (\n                    <div className=\"relative h-48 w-full\">\n                      <Image\n                        src={urlFor(post.coverImage).width(400).height(300).url()}\n                        alt={post.title}\n                        fill\n                        sizes=\"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw\"\n                        className=\"object-cover\"\n                      />\n                    </div>\n                  )}\n                  <div className=\"p-6\">\n                    <h2 className=\"text-xl font-semibold mb-2\">{post.title}</h2>\n                    {post.excerpt && (\n                      <p className=\"text-gray-600 text-sm mb-4 line-clamp-2\">\n                        {post.excerpt}\n                      </p>\n                    )}\n                    {post.publishedAt && (\n                      <p className=\"text-xs text-gray-500\">\n                        {new Date(post.publishedAt).toLocaleDateString(\"en-US\", {\n                          year: \"numeric\",\n                          month: \"long\",\n                          day: \"numeric\",\n                        })}\n                      </p>\n                    )}\n                  </div>\n                </Link>\n              ))}\n            </div>\n          )}\n        </div>\n      </main>\n      <Footer />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;;;;;;;;AAKA,MAAM,UAAU,6DAAoC;AAE7C,MAAM,WAAqB;IAChC,OAAO;IACP,aAAa;IACb,WAAW;QACT,OAAO;QACP,aAAa;QACb,KAAK,GAAG,QAAQ,SAAS,CAAC;QAC1B,UAAU;QACV,MAAM;IACR;IACA,SAAS;QACP,MAAM;QACN,OAAO;QACP,aAAa;IACf;AACF;AAEA,eAAe;IACb,gCAAgC;IAChC,MAAM;IACN;;IAKA,QAAQ,GAAG,CAAC,0BAA0B;IACtC,QAAQ,GAAG,CAAC,qBAAqB,2HAAU;IAE3C,IAAI;QACF,MAAM,QAAQ,MAAM,uHAAM,CAAC,KAAK,CAAC,2HAAU;QAC3C,QAAQ,GAAG,CAAC,mCAAmC,OAAO,UAAU;QAChE,IAAI,SAAS,MAAM,MAAM,GAAG,GAAG;YAC7B,QAAQ,GAAG,CAAC,0BAA0B,KAAK,SAAS,CAAC,KAAK,CAAC,EAAE,EAAE,MAAM;QACvE;QACA,OAAO,SAAS,EAAE;IACpB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,oCAAoC;QAClD,IAAI,iBAAiB,OAAO;YAC1B,QAAQ,KAAK,CAAC,6BAA6B,MAAM,OAAO;YACxD,QAAQ,KAAK,CAAC,2BAA2B,MAAM,KAAK;QACtD;QACA,OAAO,EAAE;IACX;AACF;AAEe,eAAe;IAC5B,MAAM,QAAQ,MAAM;IAEpB,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC,oIAAU;;;;;0BACX,8OAAC;gBAAK,WAAU;0BACd,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAA0B;;;;;;sCACxC,8OAAC;4BAAE,WAAU;sCAA8B;;;;;;wBAG1C,MAAM,MAAM,KAAK,kBAChB,8OAAC;4BAAI,WAAU;sCACZ,oDACC,wCAqBA;;kDACE,8OAAC;wCAAE,WAAU;kDAAqB;;;;;;kDAGlC,8OAAC,0LAAI;wCACH,MAAK;wCACL,WAAU;kDACX;;;;;;;;;;;;iDAOP,8OAAC;4BAAI,WAAU;sCACZ,MAAM,GAAG,CAAC,CAAC,qBACV,8OAAC,0LAAI;oCAEH,MAAM,CAAC,UAAU,EAAE,KAAK,IAAI,EAAE;oCAC9B,WAAU;;wCAET,KAAK,UAAU,kBACd,8OAAC;4CAAI,WAAU;sDACb,cAAA,8OAAC,wIAAK;gDACJ,KAAK,IAAA,uHAAM,EAAC,KAAK,UAAU,EAAE,KAAK,CAAC,KAAK,MAAM,CAAC,KAAK,GAAG;gDACvD,KAAK,KAAK,KAAK;gDACf,IAAI;gDACJ,OAAM;gDACN,WAAU;;;;;;;;;;;sDAIhB,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDAAG,WAAU;8DAA8B,KAAK,KAAK;;;;;;gDACrD,KAAK,OAAO,kBACX,8OAAC;oDAAE,WAAU;8DACV,KAAK,OAAO;;;;;;gDAGhB,KAAK,WAAW,kBACf,8OAAC;oDAAE,WAAU;8DACV,IAAI,KAAK,KAAK,WAAW,EAAE,kBAAkB,CAAC,SAAS;wDACtD,MAAM;wDACN,OAAO;wDACP,KAAK;oDACP;;;;;;;;;;;;;mCA5BD,KAAK,GAAG;;;;;;;;;;;;;;;;;;;;;0BAsCzB,8OAAC,gIAAM;;;;;;;;;;;AAGb"}}]
}